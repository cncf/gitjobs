{% extends "base.html" %}

{% block main %}
  {# Drawer mobile #}
  <div id="drawer-menu"
       role="dialog"
       data-open="false"
       class="fixed top-0 left-0 h-screen overflow-y-auto transition-transform -translate-x-full z-40 w-80"
       tabindex="-1">

    <div class="w-full h-full p-4 bg-white">
      <button type="button"
              id="close-drawer-menu"
              class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 absolute top-2.5 end-2.5 flex items-center justify-center">
        <div class="svg-icon size-5 bg-gray-400 icon-close"></div>
        <span class="sr-only">Close menu</span>
      </button>

      <div class="mt-12">
        {% block menu %}
        {% endblock menu %}
      </div>
    </div>
    <div id="drawer-menu-backdrop" class="bg-gray-900/50 fixed inset-0 z-[-1]"></div>
  </div>
  {# End Drawer mobile #}

  {# Sticky menu #}
  <aside class="hidden lg:block h-screen sticky top-0 lg:w-[250px]">
    <div class="flex flex-col justify-between h-full p-5 pt-24">
      <div>
        {% block menu %}
        {% endblock menu %}
      </div>

      <div>
        <div class="flex flex-row items-center justify-between border px-3 py-2 rounded-lg bg-white">
          <div class="flex items-center">
            {# Image #}
            <div>
              <img class="size-8 bg-gray-200 p-1 rounded-full"
                   height="32"
                   width="32"
                   src="/static/images/user.png"
                   alt="User avatar">
              {# Initials #}
              {# <div class="relative inline-flex items-center justify-center w-10 h-10 overflow-hidden bg-gray-100 rounded-full dark:bg-gray-600">
              <span class="font-medium text-gray-600 dark:text-gray-300">JL</span>
            </div> #}
              {# End initials #}
            </div>
            {# End image #}

            {# Name #}
            <div class="ms-3 text-sm">Jane Smith</div>
            {# End name #}
          </div>

          {# Logout #}
          <a href="/log-out" class="btn-tertiary size-8 p-1">
            <div class="h-full w-full flex items-center justify-center">
              <div class="svg-icon size-4 m-auto icon-logout"></div>
            </div>
          </a>
          {# End logout #}
        </div>
      </div>
    </div>
  </aside>
  {# End sticky menu #}

  <main class="w-full lg:w-[calc(100%-250px)] bg-white border rounded-3xl m-5 lg:ms-0 mt-[75px] relative">
    <div class="block lg:hidden absolute top-5 start-5">
      <button type="button" id="open-drawer-menu" class="btn-primary px-5 py-3.5">
        <div class="svg-icon size-3 icon-menu"></div>
        <span class="sr-only">Open menu</span>
      </button>
    </div>

    {% block dashboard_main %}
    {% endblock dashboard_main %}
  </main>
  <script type="module">
    import {
      toggleDrawerVisibility
    } from '/static/js/common/common.js';

    // Open drawer menu
    const openDrawerButton = document.getElementById('open-drawer-menu');
    if (openDrawerButton) {
      openDrawerButton.addEventListener('click', () => {
        toggleDrawerVisibility('drawer-menu');
      });
    }

    // Close drawer menu
    const closeDrawerButton = document.getElementById('close-drawer-menu');
    closeDrawerButton.addEventListener('click', () => {
      toggleDrawerVisibility('drawer-menu');
    });

    // Close drawer menu when clicking on a link inside the drawer
    const drawerMenu = document.getElementById('drawer-menu');
    drawerMenu.addEventListener('click', (e) => {
      if (e.target.tagName === 'A') {
        toggleDrawerVisibility('drawer-menu');
      }
    });

    // Close drawer menu when clicking on the backdrop
    const drawerMenuBackdrop = document.getElementById('drawer-menu-backdrop');
    drawerMenuBackdrop.addEventListener('click', () => {
      toggleDrawerVisibility('drawer-menu');
    });
  </script>
{% endblock main %}
