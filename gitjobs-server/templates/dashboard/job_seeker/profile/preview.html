<div class="flex space-x-5 items-center mb-10 pb-10 border-b">
  {# Photo #}
  {% if let Some(photo_id) = profile.photo_id %}
    {% let photo = &self::build_image_url(photo_id, "small") %}
    <div class="bg-gray-100 p-2 size-24 rounded-full flex items-center justify-center">
      <img src="{{ photo }}"
           alt="{{ profile.name }} photo"
           height="80"
           width="80"
           class="size-18 rounded-full">
    </div>
  {% endif %}
  {# End photo #}

  <div class="flex flex-col space-y-3">
    {# Name #}
    <div class="uppercase text-2xl font-semibold">{{ profile.name }}</div>
    {# End name #}

    <div class="flex flex-wrap space-x-5">
      {# Email #}
      {% call main_badge(content = profile.email, icon = "email") %}
      {# End email #}

      {# Phone #}
      {% if let Some(phone) = profile.phone %}
        {% call main_badge(content = phone, icon = "phone") %}
      {% endif %}
      {# End phone #}

      {# Location #}
      {% if let Some(location_id) = profile.location_id %}
        {% let location = &self::build_location(profile.city.as_deref(), profile.state.as_deref(), profile.country.as_deref())|display_some %}

        {% call main_badge(content = location, icon = "location") %}
      {% endif %}
      {# End location #}
    </div>
  </div>
</div>

<div class="flex items-stretch">
  {# Left column #}
  <div class="w-1/4 pe-10 me-10 border-e flex space-y-10 flex-col">

    {# Social #}
    <div class="flex flex-col space-y-3">
      {# Website url #}
      {% if let Some(website_url) = profile.website_url %}
        {% call social_link(url = website_url, icon = "link") %}
      {% endif %}
      {# End website url #}

      {# GitHub url #}
      {% if let Some(github_url) = profile.github_url %}
        {% call social_link(url = github_url, icon = "github") %}
      {% endif %}
      {# End GitHub url #}

      {# LinkedIn url #}
      {% if let Some(linkedin_url) = profile.linkedin_url %}
        {% call social_link(url = linkedin_url, icon = "linkedin") %}
      {% endif %}
      {# End LinkedIn url #}

      {# Twitter url #}
      {% if let Some(twitter_url) = profile.twitter_url %}
        {% call social_link(url = twitter_url, icon = "twitter") %}
      {% endif %}
      {# End Twitter url #}

      {# Facebook url #}
      {% if let Some(facebook_url) = profile.facebook_url %}
        {% call social_link(url = facebook_url, icon = "facebook") %}
      {% endif %}
      {# End Facebook url #}
    </div>
    {# End social #}

    <hr class="my-10 border-t border-gray-200">
    <div class="flex flex-col space-y-4">
      {# Availability #}
      {% call title(content = "open to") %}
      <label class="inline-flex items-center">
        <input type="checkbox"
               value=""
               class="sr-only peer"
               disabled
               {% if let Some(open_to_remote) = profile.open_to_remote -%}
               {%- if open_to_remote -%}
               checked
               {%- endif -%}
               {%- endif %}>
        <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600">
        </div>
        <span class="ms-3 text-sm font-medium text-gray-700">Remote</span>
      </label>
      <label class="inline-flex items-center">
        <input type="checkbox"
               value=""
               class="sr-only peer"
               disabled
               {% if let Some(open_to_relocation) = profile.open_to_relocation -%}
               {%- if open_to_relocation -%}
               checked
               {%- endif -%}
               {%- endif %}>
        <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-primary-300 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary-600">
        </div>
        <span class="ms-3 text-sm font-medium text-gray-700">Relocation</span>
      </label>
    </div>

    {# Skills #}
    {% if let Some(skills) = profile.skills %}
      <hr class="my-10 border-t border-gray-200">

      <div>
        {% call title(content = "Skills") %}
        <div class="text-gray-600 text-xs/6 flex flex-wrap mt-2">
          {% for skill in skills %}
            <div class="bg-gray-100 px-4 rounded-full inline-block capitalize mb-2 me-2">{{ skill|unnormalize }}</div>
          {% endfor %}
        </div>
      </div>
    {% endif %}
    {# End skills #}

  </div>
  {# End left column #}

  {# Right column #}
  <div class="w-3/4">
    {# Summary #}
    {% call title(content = "Profile") %}
    <div class="text-sm/6 text-gray-600 markdown">{{ profile.summary|md_to_html|safe }}</div>
    {# End summary #}

    {# Experience #}
    {% if let Some(experience) = profile.experience %}
      <hr class="my-10 border-t border-gray-200">
      {% call title(content = "Experience") %}
      <ol class="relative border-s border-gray-200">
        {% for exp in experience %}
          {% let end_date = exp.end_date|display_some_date_or(DATE_FORMAT_2, "Present") %}
          {% call timeline_item(title = exp.title, entity = exp.company, description = exp.description, start_date = exp.start_date.format(DATE_FORMAT_2), end_date = end_date) %}
        {% endfor %}
      </ol>
    {% endif %}
    {# End experience #}

    {# Education #}
    {% if let Some(education) = profile.education %}
      <hr class="my-10 border-t border-gray-200">
      {% call title(content = "Education") %}
      <ol class="relative border-s border-gray-200">
        {% for ed in education %}
          {% call timeline_item(title = ed.title, entity = ed.educational_institution, description = ed.description, start_date = ed.start_date.format(DATE_FORMAT_2), end_date = ed.end_date.format(DATE_FORMAT_2)) %}
        {% endfor %}
      </ol>
    {% endif %}
    {# End education #}

    {# Certifications #}
    {% if let Some(certifications) = profile.certifications %}
      <hr class="my-10 border-t border-gray-200">
      {% call title(content = "Certifications") %}
      <ol class="relative border-s border-gray-200">
        {% for c in certifications %}
          {% call timeline_item(title = c.title, entity = c.provider, description = c.description, start_date = c.start_date.format(DATE_FORMAT_2), end_date = c.end_date.format(DATE_FORMAT_2)) %}
        {% endfor %}
      </ol>
    {% endif %}
    {# End certifications #}

    {# Projects #}
    {% if let Some(projects) = profile.projects %}
      <hr class="my-10 border-t border-gray-200">
      {% call title(content = "Projects") %}
      <ol class="items-start sm:flex overflow-x-auto">
        {% for p in projects %}
          <li class="relative mb-6 sm:mb-0 min-w-[300px]">
            {% if projects.len() > 1 %}
              <div class="flex items-center">
                <div class="z-10 flex items-center justify-center size-6 bg-gray-200 rounded-full shrink-0">
                  <div class="svg-icon size-3 icon-project bg-gray-600"></div>
                </div>
                <div class="hidden sm:flex w-full bg-gray-200 h-0.5 dark:bg-gray-700"></div>
              </div>
            {% endif %}
            <div class="mt-3 sm:pe-8">
              <div class="text-lg font-semibold text-gray-900 truncate">{{ p.title }}</div>
              <div class="text-sm/6 text-gray-500 italic">
                <a href="{{ p.url }}"
                   class="truncate"
                   target="_blank"
                   rel="noopener noreferrer">{{ p.url }}</a>
              </div>
              {% if let Some(source_url) = p.source_url %}
                <div class="text-sm/6 text-gray-500 italic">
                  <span class="text-xs text-gray-400 uppercase">Source:</span>
                  <a href="{{ source_url }}"
                     class="truncate"
                     target="_blank"
                     rel="noopener noreferrer">{{ source_url }}</a>
                </div>
              {% endif %}
              <div class="text-sm/6 text-gray-600 markdown mt-3">{{ p.description|md_to_html|safe }}</div>
            </div>
          </li>
        {% endfor %}
      </ol>
    {% endif %}
    {# End projects #}
  </div>
  {# End right column #}
</div>

{% macro main_badge(content, icon) %}
  <div class="border rounded-full px-4 flex items-center text-gray-600 text-sm/6 space-x-2">
    <div class="svg-icon size-4 icon-{{ icon }} bg-gray-500"></div>
    <div>{{ content }}</div>
  </div>
{% endmacro main_badge %}

{% macro title(content) %}
  <div class="uppercase text-gray-800 tracking-[0.25rem] font-semibold mb-3">{{ content }}</div>
{% endmacro title %}

{% macro social_link(url, icon) %}
  <a href="url"
     class="btn-tertiary border btn-mini flex items-center space-x-2"
     target="_blank"
     rel="noopener noreferrer">
    <div class="svg-icon size-3 bg-gray-300 icon-{{ icon }}"></div>
    <div class="truncate">{{ url }}</div>
  </a>
{% endmacro social_link %}

{% macro timeline_item(title, entity, description, start_date, end_date) %}
  <li class="mb-10 ms-4">
    <div class="absolute size-3 bg-gray-300 rounded-full mt-1 -start-1.5 border border-white"></div>
    <div class="mb-2 text-sm text-gray-400">{{ start_date }} - {{ end_date }}</div>
    <div class="text-lg font-semibold text-gray-900">{{ title }}</div>
    <div class="text-sm/6 text-gray-500 italic mb-3">{{ entity }}</div>
    <div class="text-sm/6 text-gray-600 markdown">{{ description|md_to_html|safe }}</div>
  </li>
{% endmacro timeline_item %}
