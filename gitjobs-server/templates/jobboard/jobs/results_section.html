{% import "macros/jobboard.html" as jobboard -%}

<div class="flex flex-col mt-5 md:mt-7 space-y-4">
  {% if jobs.len() == 0 -%}
    {# Placeholder cards -#}
    <div class="border-t border-stone-100 border-b p-10 md:p-14">
      <div class="border border-primary-300 p-5 lg:p-10 text-sm text-stone-800 rounded-lg bg-primary-50/20 text-center"
           role="alert">
        <div class="text-md lg:text-lg">
          <p class="mb-5 lg:mb-10">We can't seem to find any jobs that match your search criteria.</p>
          <p>
            You can
            <button id="reset-link-mobile-filters"
                    class="cursor-pointer inline lg:hidden p-0 underline">reset</button>
            <button id="reset-link-desktop-filters"
                    class="cursor-pointer hidden lg:inline p-0 underline">reset</button>
            your filters or try a different search.
          </p>
        </div>
      </div>
    </div>
    {# End placeholder cards -#}
  {% else -%}
    {# Cards -#}
    {% for job in jobs -%}
      {% let open_source = job.open_source.unwrap_or_default() -%}
      {% let upstream_commitment = job.upstream_commitment.unwrap_or_default() -%}

      <button id="job-preview-{{ job.job_id }}"
              data-preview-job="true"
              data-job-id="{{ job.job_id }}"
              data-job-title="{{ job.title }}"
              data-job-company="{{ job.employer.company }}"
              hx-get="/section/jobs/{{ job.job_id }}"
              hx-target="#job-view"
              hx-trigger="click,open-modal,open-modal-on-popstate"
              hx-indicator="#spinner-{{ job.job_id }}"
              class="relative md:mx-7 text-start bg-white enabled:cursor-pointer border rounded-lg enabled:hover:outline enabled:hover:outline-1 p-5 md:p-7 {%- if upstream_commitment > 0 %} border-lime-500 bg-lime-50/20 enabled:hover:outline-lime-500{%- else if open_source > 0 %} border-lime-300 bg-lime-50/20 enabled:hover:outline-lime-300{%- else %} border-stone-200 enabled:hover:outline-stone-200{%- endif -%}"
              hx-disabled-elt="[data-preview-job]"
              hx-boost="true">{{ jobboard::job_card(job = job) -}}</button>
    {% endfor -%}
    {# End cards -#}
  {% endif -%}
</div>

{# Pagination -#}
{% if jobs.len() > 0 %}{{ navigation_links|safe }}{% endif %}
{# End pagination -#}

{# djlint:off #}
<script type="module">
  import {
    initializeJobboardResults
  } from '/static/js/jobboard/results.js';

  initializeJobboardResults({
    hasJobs: {% if jobs.len() > 0 -%}true{%- else -%}false{%- endif %},
    currentPageContent: '{% if jobs.len() > 0 -%}{{ jobboard::current_page(total, jobs.len(), offset) -}}{%- endif %}'
  });
</script>
{# djlint:on #}
{# End list view -#}
